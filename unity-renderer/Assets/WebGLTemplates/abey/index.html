<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Decentraland</title>
    <script src="./abey.js"></script>
    <style>
      body{
        background-color: black;
      }
      .gameContainer {
        width: 100%;
        height: 100%;
        margin: auto;
      }

      canvas {
        width: 100%;
        height: 100%;
        margin: auto;
      }
    </style>

  </head>

  <body>

    <div class="gameContainer" style="width: 100%; height: 100%; margin: auto">
      <canvas></canvas>
    </div>

    <script>
      
      // This is the unity set up, its standard
      // the compiler will replace the values
      var gameInstance;
      var buildUrl  = "Build";
      const config = {
          dataUrl:  buildUrl + "/{{{ DATA_FILENAME }}}",
	        frameworkUrl: buildUrl + "/{{{ FRAMEWORK_FILENAME }}}",
	        codeUrl: buildUrl + "/{{{ CODE_FILENAME }}}",
	        streamingAssetsUrl: "StreamingAssets",
	        companyName: "{{{ COMPANY_NAME }}}",
          productName: "{{{ PRODUCT_NAME }}}",
          productVersion: "{{{ PRODUCT_VERSION }}}",

	    };

      var canvas = document.querySelector('canvas');
      
      var script = document.createElement("script");
      script.src = `${buildUrl}/{{{ LOADER_FILENAME }}}`;
      script.onload = () => {
        
        // code for instantiating the build
        createUnityInstance(canvas, config, (loadedPrecent)=>{onProgress(loadedPrecent);})
        .then((instance)=>{
          $abeyworld.SetGameInstance(instance)
          gameInstance = instance;
          onProgress(1.0);
          $abeyworld.ActivateRendering();
        })
        .catch((message)=>console.log(message));
      };
      document.body.appendChild(script);


	  
      function onProgress(loadedPrecent){
        // update loading -> loadedPrecent =  0.0 to 1.0
        // code here to updated some progress bar for the loading screen
      }

    </script>
  </body>
</html>
